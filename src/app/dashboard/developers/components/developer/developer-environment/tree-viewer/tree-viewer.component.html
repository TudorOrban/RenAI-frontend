<div class="p-4 border border-gray-300 h-full">
    <div *ngIf="tree">
        <ng-container *ngTemplateOutlet="treeNode; context: { $implicit: tree.root }"></ng-container>
    </div>

    <ng-template #treeNode let-node>
        <div class="ml-8 py-2">
            <div *ngIf="node.directory === true" class="flex items-center space-x-2">
                <button (click)="toggleExpanded(node)" class="hover:text-gray-800">
                    <fa-icon [icon]="getCaretIcon(node)" class="text-sm text-gray-700"></fa-icon>
                </button>
                <fa-icon [icon]="faFolder" class="text-sm text-gray-700"></fa-icon>
                <span *ngIf="node.directory === true" class="font-semibold">
                    {{ node.name }}
                </span>
            </div>
            <div *ngIf="node.directory === false" class="flex items-center space-x-2">
                <fa-icon [icon]="faFile" class="text-sm text-gray-700"></fa-icon>
                <button class="text-blue-700 hover:underline" (click)="readFile(node.path)">
                    {{ node.name }}
                </button>
            </div>
            
            <div *ngIf="node.isExpanded">
                <ng-container *ngFor="let child of node.children">
                    <ng-container *ngTemplateOutlet="treeNode; context: { $implicit: child }"></ng-container>
                </ng-container>
            </div>
        </div>
    </ng-template>
</div>